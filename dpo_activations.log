2025-08-10 18:11:04,763 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-10 18:11:04,765 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-10 18:17:18,649 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-10 18:17:18,652 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-10 18:17:35,605 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-10 18:18:14,349 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-10 18:22:32,927 - INFO - Loading dataset from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json
2025-08-10 18:22:32,935 - INFO - Loaded 16 chosen and 16 rejected conversations from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json using chosen='pi_response', rejected='llama_response'.
2025-08-10 18:22:32,936 - INFO - Loaded 16 chosen conversations and 16 rejected conversations
2025-08-10 18:22:32,964 - ERROR - Error processing conversation 0: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:32,976 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:32,983 - ERROR - Error processing conversation 1: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:32,983 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:32,989 - ERROR - Error processing conversation 2: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:32,990 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:32,995 - ERROR - Error processing conversation 3: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:32,995 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,000 - ERROR - Error processing conversation 4: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,001 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,006 - ERROR - Error processing conversation 5: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,007 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,012 - ERROR - Error processing conversation 6: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,012 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,017 - ERROR - Error processing conversation 7: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,018 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,023 - ERROR - Error processing conversation 8: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,024 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,029 - ERROR - Error processing conversation 9: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,029 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,035 - ERROR - Error processing conversation 10: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,035 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,040 - ERROR - Error processing conversation 11: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,040 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,046 - ERROR - Error processing conversation 12: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,046 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,051 - ERROR - Error processing conversation 13: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,052 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,059 - ERROR - Error processing conversation 14: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,059 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,064 - ERROR - Error processing conversation 15: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'
2025-08-10 18:22:33,065 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 215, in get_activations_for_conversation
    _, cache = model.run_with_cache(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 702, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 560, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: HookedTransformer.forward() got an unexpected keyword argument 'os_slice'

2025-08-10 18:22:33,065 - INFO - Saving final results to /mnt/vast/home/lawrence/steer-llama/emoji_pi_llama_activations.h5
2025-08-10 18:22:33,073 - INFO - Processing complete. Processed 0 conversations.
2025-08-10 18:25:09,087 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-10 18:25:09,089 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-10 18:25:26,712 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-10 18:26:04,357 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-10 18:30:14,893 - INFO - Loading dataset from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json
2025-08-10 18:30:14,899 - INFO - Loaded 16 chosen and 16 rejected conversations from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json using chosen='pi_response', rejected='llama_response'.
2025-08-10 18:30:14,899 - INFO - Loaded 16 chosen conversations and 16 rejected conversations
2025-08-10 18:30:16,496 - ERROR - Error processing conversation 0: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:16,498 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:16,735 - ERROR - Error processing conversation 1: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:16,735 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:16,918 - ERROR - Error processing conversation 2: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:16,918 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,030 - ERROR - Error processing conversation 3: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,030 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,188 - ERROR - Error processing conversation 4: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,188 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,357 - ERROR - Error processing conversation 5: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,357 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,591 - ERROR - Error processing conversation 6: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,591 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,784 - ERROR - Error processing conversation 7: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,785 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:17,969 - ERROR - Error processing conversation 8: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:17,969 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:18,148 - ERROR - Error processing conversation 9: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:18,149 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:18,264 - ERROR - Error processing conversation 10: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:18,264 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:18,493 - ERROR - Error processing conversation 11: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:18,493 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:18,676 - ERROR - Error processing conversation 12: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:18,677 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:18,793 - ERROR - Error processing conversation 13: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:18,793 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:19,037 - ERROR - Error processing conversation 14: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:19,038 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:19,158 - ERROR - Error processing conversation 15: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
2025-08-10 18:30:19,159 - ERROR - Traceback: Traceback (most recent call last):
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 336, in main
    chosen_activations = get_activations_for_conversation(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/vast/home/lawrence/steer-llama/govind-hooks/process_dpo_activations.py", line 225, in get_activations_for_conversation
    activations[layer_name] = tensor_cpu.numpy()
                              ^^^^^^^^^^^^^^^^^^
TypeError: can't convert cuda:2 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

2025-08-10 18:30:19,159 - INFO - Saving final results to /mnt/vast/home/lawrence/steer-llama/emoji_pi_llama_activations.h5
2025-08-10 18:30:19,168 - INFO - Processing complete. Processed 0 conversations.
2025-08-10 18:32:23,251 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-10 18:32:23,252 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-10 18:32:40,699 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-10 18:33:18,212 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-10 18:37:31,392 - INFO - Loading dataset from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json
2025-08-10 18:37:31,397 - INFO - Loaded 16 chosen and 16 rejected conversations from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json using chosen='pi_response', rejected='llama_response'.
2025-08-10 18:37:31,397 - INFO - Loaded 16 chosen conversations and 16 rejected conversations
2025-08-10 18:40:27,640 - INFO - Saved intermediate results to activations_intermediate_10.h5
2025-08-10 18:40:32,548 - INFO - Saving final results to /mnt/vast/home/lawrence/steer-llama/emoji_pi_llama_activations.h5
2025-08-10 18:45:42,656 - INFO - Processing complete. Processed 16 conversations.
2025-08-11 22:41:29,101 - INFO - Loading configuration from config.yaml
2025-08-11 22:42:18,589 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-11 22:42:18,594 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-11 22:42:18,594 - INFO - Loading dataset from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json
2025-08-11 22:42:18,601 - INFO - Loaded 16 chosen and 16 rejected conversations from /mnt/vast/home/lawrence/steer-llama/lawrence-generation/traits/elicited/emoji_elicited_filtered.json using chosen='pi_response', rejected='llama_response'.
2025-08-11 22:42:18,601 - INFO - Loaded 16 chosen conversations and 16 rejected conversations
2025-08-11 22:43:01,242 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-11 22:43:01,248 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-11 22:45:10,233 - INFO - Loading configuration from govind-hooks/config.yaml
2025-08-11 22:45:10,235 - INFO - Loading model: meta-llama/Meta-Llama-3-70B-Instruct
2025-08-11 22:45:43,618 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 22:47:03,481 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
